<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>IVI WEB</title>
  <link rel="stylesheet" href="style.css">
</head>

<body>
  <!-- Canvas para lluvia de girasoles tipo Matrix -->
  <canvas id="girasol-canvas"></canvas>

  <!-- Contenedor del mensaje -->
  <div class="popup-container">
    <h1 id="animated-text" class="animated-word" aria-live="polite"></h1>
  </div>

  <!-- Contenedor del pastel -->
  <div id="pastel-container" style="display: none;">
    <div class="numero-cumple"></div>
    <div class="pastel-parte pastel-base"></div>
    <div class="pastel-parte capa1"></div>
    <div class="pastel-parte capa2"></div>
    <div class="pastel-parte capa3"></div>

    <!-- Velas -->
    <div class="vela vela-izquierda">
      <div class="llama"></div>
    </div>
    <div class="vela vela-derecha">
      <div class="llama"></div>
    </div>
  </div>

  <script>
  window.addEventListener("DOMContentLoaded", function () {
    const a침oActual = new Date().getFullYear();
    const edad = a침oActual - 2004;

    const numeroCumple = document.querySelector(".numero-cumple");
    if (numeroCumple) {
      numeroCumple.textContent = edad;
    }
  });
  </script>

  <!-- Regalos animados -->
  <div class="regalo regalo-izquierdo aparecer retardo">
    <div class="tapa"></div>
    <div class="cinta-vertical"></div>
    <div class="mo침o"></div>
  </div>

  <div class="regalo regalo-derecho aparecer retardo">
    <div class="tapa"></div>
    <div class="cinta-vertical"></div>
    <div class="mo침o"></div>
  </div>

  <!-- Bot칩n de descarga -->
  <div id="boton-descarga" style="display: none;">
    <a href="Pisuke.zip" download>
      <button class="boton-azul">Instala tu regalo 游눟</button>
    </a>
  </div>

  <!-- Scripts -->
  <script>
    // Texto palabra por palabra
    const mensaje = "FELIZ CUMPLEA칌OS CHICA HELADO";
    const palabras = mensaje.split(" ");
    const contenedor = document.getElementById("animated-text");
    let i = 0;

    function mostrarPalabra() {
      contenedor.innerText = palabras[i];
      contenedor.classList.remove("animated-word");
      void contenedor.offsetWidth; // Re-trigger animation
      contenedor.classList.add("animated-word");

      i++;
      if (i < palabras.length) {
        setTimeout(mostrarPalabra, 2000);
      } else {
        setTimeout(() => {
          contenedor.classList.remove("animated-word");
          contenedor.classList.add("final-word");
          contenedor.style.display = "none";
          document.getElementById("pastel-container").style.display = "flex";
        }, 2500);
      }
    }

    mostrarPalabra();

    // Efecto Matrix con girasoles
    const canvas = document.getElementById("girasol-canvas");
    const ctx = canvas.getContext("2d");

    function ajustarCanvas() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    }

    ajustarCanvas();

    const fontSize = 50;
    const columns = Math.floor(canvas.width / fontSize);
    const drops = new Array(columns).fill(0);

    function draw() {
      ctx.fillStyle = "rgba(0, 0, 0, 0.1)";
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      ctx.font = `${fontSize}px serif`;
      ctx.fillStyle = "rgba(255, 255, 0, 0.8)";
      ctx.textAlign = "center";

      for (let i = 0; i < drops.length; i++) {
        const x = i * fontSize + fontSize / 2;
        const y = Math.floor(drops[i]) * fontSize;

        ctx.fillText("游꺝", x, y);

        if (y > canvas.height && Math.random() > 0.975) {
          drops[i] = 0;
        }

        drops[i] += 0.2;
      }

      requestAnimationFrame(draw);
    }

    draw();

    window.addEventListener("resize", () => {
      ajustarCanvas();
    });

    // Mostrar bot칩n de descarga despu칠s de 10s
    setTimeout(() => {
      const boton = document.getElementById("boton-descarga");
      boton.style.display = "block";
      boton.classList.add("visible");
    }, 10000);
  </script>
</body>
</html>
